{% extends 'core/base.html' %}

{% block title %}VideoTube{% endblock %}

{% block content %}
<!-- Category Pills -->
<div class="category-pills">
    <a href="{% url 'home' %}" class="pill {% if not category %}active{% endif %}">Tümü</a>
    <a href="{% url 'home' %}?category=Müzik" class="pill {% if category == 'Müzik' %}active{% endif %}">Müzik</a>
    <a href="{% url 'home' %}?category=Mixler" class="pill {% if category == 'Mixler' %}active{% endif %}">Mix'ler</a>
    <a href="{% url 'home' %}?category=Oyun" class="pill {% if category == 'Oyun' %}active{% endif %}">Oyun</a>
    <a href="{% url 'home' %}?category=Canlı" class="pill {% if category == 'Canlı' %}active{% endif %}">Canlı</a>
    <a href="{% url 'home' %}?category=Haberler"
        class="pill {% if category == 'Haberler' %}active{% endif %}">Haberler</a>
    <a href="{% url 'home' %}?category=Spor" class="pill {% if category == 'Spor' %}active{% endif %}">Spor</a>
    <a href="{% url 'home' %}?category=Eğitim" class="pill {% if category == 'Eğitim' %}active{% endif %}">Eğitim</a>
    <a href="{% url 'home' %}?category=Komedi" class="pill {% if category == 'Komedi' %}active{% endif %}">Komedi</a>
    <a href="{% url 'home' %}?category=Filmler" class="pill {% if category == 'Filmler' %}active{% endif %}">Filmler</a>
</div>

<!-- YouTube Videos Section -->
{% if youtube_videos %}
<div class="video-grid">
    {% for video in youtube_videos %}
    <div class="video-card">
        <a href="{{ video.youtube_url }}" target="_blank" class="video-thumbnail">
            <img src="{{ video.thumbnail }}" alt="{{ video.title }}">
            <span class="video-duration">{{ video.duration|default:"0:00" }}</span>
            <div class="thumbnail-overlay">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor"
                        d="M12 3.67c-4.58 0-8.33 3.75-8.33 8.33s3.75 8.33 8.33 8.33 8.33-3.75 8.33-8.33S16.58 3.67 12 3.67zm3.21 11.29-4.04-2.34V7.5h1.67v4.14l3.04 1.76-.67 1.56z" />
                </svg>
            </div>
        </a>
        <div class="video-info">
            <a href="https://www.youtube.com/channel/{{ video.channel_id }}" target="_blank" class="video-avatar">
                {{ video.channel_title|slice:":1"|upper }}
            </a>
            <div class="video-details">
                <a href="{{ video.youtube_url }}" target="_blank" class="video-title">{{ video.title }}</a>
                <a href="https://www.youtube.com/channel/{{ video.channel_id }}" target="_blank" class="video-channel">
                    {{ video.channel_title }}
                    <svg class="verified-badge" viewBox="0 0 24 24" width="14" height="14">
                        <path fill="currentColor"
                            d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zM9.8 17.3l-4.2-4.1L7 11.8l2.8 2.7L17 7.4l1.4 1.4-8.6 8.5z" />
                    </svg>
                </a>
                <div class="video-meta">
                    <span>{{ video.formatted_views }} görüntüleme</span>
                    <span class="separator">•</span>
                    <span>{{ video.published_at|slice:":10" }}</span>
                </div>
            </div>
            <button class="video-menu-btn">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor"
                        d="M12 16.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zM10.5 12c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5-1.5.67-1.5 1.5zm0-6c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5-1.5.67-1.5 1.5z" />
                </svg>
            </button>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- Local Videos Section -->
{% if videos %}
<div class="section-header" style="margin-top: 40px;">
    <div class="section-title">
        <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor"
                d="M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z" />
        </svg>
        <span>Yüklenen Videolar</span>
    </div>
</div>
<div class="video-grid">
    {% for video in videos %}
    <div class="video-card">
        <a href="{% url 'video_detail' video.pk %}" class="video-thumbnail">
            {% if video.thumbnail %}
            <img src="{{ video.thumbnail.url }}" alt="{{ video.title }}">
            {% else %}
            <div class="thumbnail-placeholder">
                <svg viewBox="0 0 24 24" width="48" height="48">
                    <path fill="currentColor" d="M8 5v14l11-7z" />
                </svg>
            </div>
            {% endif %}
            <span class="video-duration">0:00</span>
        </a>
        <div class="video-info">
            <a href="{% url 'channel' video.user.id %}" class="video-avatar">
                {{ video.user.username|slice:":1"|upper }}
            </a>
            <div class="video-details">
                <a href="{% url 'video_detail' video.pk %}" class="video-title">{{ video.title }}</a>
                <a href="{% url 'channel' video.user.id %}" class="video-channel">
                    {{ video.user.username }}
                </a>
                <div class="video-meta">
                    <span>{{ video.views }} görüntüleme</span>
                    <span class="separator">•</span>
                    <span>{{ video.created_at|timesince }} önce</span>
                </div>
            </div>
            <button class="video-menu-btn">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor"
                        d="M12 16.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zM10.5 12c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5-1.5.67-1.5 1.5zm0-6c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5-1.5.67-1.5 1.5z" />
                </svg>
            </button>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- Empty State -->
{% if not youtube_videos and not videos %}
<div class="empty-state">
    <svg viewBox="0 0 24 24" width="120" height="120">
        <path fill="currentColor" opacity="0.3"
            d="M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z" />
    </svg>
    <h2>{% if query %}"{{ query }}" için sonuç bulunamadı{% else %}YouTube API yapılandırılmadı{% endif %}</h2>
    <p>{% if not query %}Lütfen settings.py dosyasına YOUTUBE_API_KEY ekleyin{% endif %}</p>
    {% if user.is_authenticated %}
    <a href="{% url 'upload' %}" class="btn btn-primary">Video Yükle</a>
    {% endif %}
</div>
{% endif %}

{% endblock %}